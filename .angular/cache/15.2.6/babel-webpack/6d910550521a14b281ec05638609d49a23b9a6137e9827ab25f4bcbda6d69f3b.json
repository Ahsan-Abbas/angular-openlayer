{"ast":null,"code":"import _asyncToGenerator from \"D:/Angular Projects/PBSGEO (Angular Job Post)/Test Task 1/angular-openlayers/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport http from 'http';\nimport https from 'https';\nimport urlMod from 'url';\nimport { BaseClient, BaseResponse } from './base.js';\nimport { AbortError } from '../../utils.js';\nclass HttpResponse extends BaseResponse {\n  /**\n   * BaseResponse facade for node HTTP/HTTPS API Response\n   * @param {http.ServerResponse} response\n   */\n  constructor(response, dataPromise) {\n    super();\n    this.response = response;\n    this.dataPromise = dataPromise;\n  }\n  get status() {\n    return this.response.statusCode;\n  }\n  getHeader(name) {\n    return this.response.headers[name];\n  }\n  getData() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const data = yield _this.dataPromise;\n      return data;\n    })();\n  }\n}\nexport class HttpClient extends BaseClient {\n  constructor(url) {\n    super(url);\n    this.parsedUrl = urlMod.parse(this.url);\n    this.httpApi = this.parsedUrl.protocol === 'http:' ? http : https;\n  }\n  constructRequest(headers, signal) {\n    return new Promise((resolve, reject) => {\n      const request = this.httpApi.get({\n        ...this.parsedUrl,\n        headers\n      }, response => {\n        const dataPromise = new Promise(resolveData => {\n          const chunks = [];\n\n          // collect chunks\n          response.on('data', chunk => {\n            chunks.push(chunk);\n          });\n\n          // concatenate all chunks and resolve the promise with the resulting buffer\n          response.on('end', () => {\n            const data = Buffer.concat(chunks).buffer;\n            resolveData(data);\n          });\n          response.on('error', reject);\n        });\n        resolve(new HttpResponse(response, dataPromise));\n      });\n      request.on('error', reject);\n      if (signal) {\n        if (signal.aborted) {\n          request.destroy(new AbortError('Request aborted'));\n        }\n        signal.addEventListener('abort', () => request.destroy(new AbortError('Request aborted')));\n      }\n    });\n  }\n  request({\n    headers,\n    signal\n  } = {}) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const response = yield _this2.constructRequest(headers, signal);\n      return response;\n    })();\n  }\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}